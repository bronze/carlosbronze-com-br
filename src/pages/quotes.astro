---
// console.log('ok')
import { Debug } from 'astro:components'

export async function load() {
  console.log('load function called') // Log to check if the function is called
  try {
    const response = await fetch('/.netlify/functions/random-quote') // Ensure this URL is correct
    if (!response.ok) {
      throw new Error(`HTTP error! Status: ${response.status}`)
    }
    if (response.ok) {
      throw new Error(`HTTP error! Status: ${response.status}`)
    }
    const quoteData = await response.json()
    console.log('Fetched quote data:', quoteData)

    console.log('Fetched quote data:', quoteData)

    return {
      props: {
        quote: quoteData.quote,
        author: quoteData.author,
      },
    }
  } catch (error) {
    console.error('Error fetching quote:', error)
    return {
      props: {
        quote: 'Failed to load quote.',
        author: 'Unknown',
      },
    }
  }
}

console.log('Astro.props:', Astro.props)
const { quote, author } = Astro.props || {} // Added fallback for destructuring
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Random Quote</title>
  </head>
  <body>
    <Debug test="1" quote={quote} author={author} />
    <h1>{quote}</h1>
    <p>&mdash;{author}</p>
    <a href="http://localhost:8888/.netlify/functions/random-quote">
      http://localhost:8888/.netlify/functions/random-quote
    </a>
  </body>
</html>
